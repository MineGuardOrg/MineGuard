<mat-card class="cardWithShadow helmet-card">
  <mat-card-content>
    <!-- Header -->
    <div class="card-header">
      <div>
        <mat-card-title>{{ 'HELMET.TITLE' | translate }}</mat-card-title>
      </div>
      <div class="status-badge" 
           [style.background-color]="safetyStatus.color + '20'" 
           [style.border-color]="safetyStatus.color">
        <mat-icon [style.color]="safetyStatus.color">{{ safetyStatus.icon }}</mat-icon>
        <!-- CAMBIO CLAVE: Usar pipe translate dinámicamente según el estado -->
        <span [style.color]="safetyStatus.color">
          {{ ('HELMET.STATUS.' + safetyStatus.status.toUpperCase()) | translate }}
        </span>
      </div>
    </div>
    <!-- Main Container -->
    <div class="helmet-container">
      <!-- Left: 3D Visualization -->
      <div class="visualization-area">
        <canvas #canvas3d class="canvas-3d" [style.box-shadow]="getHelmetGlow()"></canvas>
      </div>
      <!-- Right: Live Data -->
      <div class="data-panel">
        <div class="data-grid">

          <!-- Pitch -->
          <div class="data-item pitch">
            <div class="data-icon">
              <mat-icon>arrow_upward</mat-icon>
            </div>
            <div class="data-info">
              <span class="data-label">{{ 'HELMET.AXES.PITCH' | translate }}</span>
              <span class="data-value">{{ (gyroData?.pitch || 0).toFixed(1) }}°</span>
            </div>
          </div>
          <!-- Roll -->
          <div class="data-item roll">
            <div class="data-icon">
              <mat-icon>swap_horiz</mat-icon>
            </div>
            <div class="data-info">
              <span class="data-label">{{ 'HELMET.AXES.ROLL' | translate }}</span>
              <span class="data-value">{{ (gyroData?.roll || 0).toFixed(1) }}°</span>
            </div>
          </div>
          <!-- Yaw -->
          <div class="data-item yaw">
            <div class="data-icon">
              <mat-icon>rotate_right</mat-icon>
            </div>
            <div class="data-info">
              <span class="data-label">{{ 'HELMET.AXES.YAW' | translate }}</span>
              <span class="data-value">{{ (gyroData?.yaw || 0).toFixed(1) }}°</span>
            </div>
          </div>
          <!-- Acceleration -->
          <div class="data-item accel">
            <div class="data-icon">
              <mat-icon>speed</mat-icon>
            </div>
            <div class="data-info">
              <span class="data-label">{{ 'HELMET.AXES.ACCELERATION' | translate }}</span>
              <span class="data-value">{{ (gyroData?.totalAccel || 0).toFixed(2) }}g</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Controls -->
    <div class="control-section" *ngIf="manualMode">
      <!-- Pitch Slider -->
      <div class="control-item">
        <label>
          <mat-icon class="pitch-color">arrow_upward</mat-icon>
          {{ 'HELMET.CONTROLS.PITCH' | translate }}: {{ pitchControl.toFixed(0) }}°
        </label>
        <mat-slider min="-90" max="90" step="1" [(ngModel)]="pitchControl" (input)="onManualChange()">
          <input matSliderThumb>
        </mat-slider>
      </div>
      <!-- Roll Slider -->
      <div class="control-item">
        <label>
          <mat-icon class="roll-color">swap_horiz</mat-icon>
          {{ 'HELMET.CONTROLS.ROLL' | translate }}: {{ rollControl.toFixed(0) }}°
        </label>
        <mat-slider min="-90" max="90" step="1" [(ngModel)]="rollControl" (input)="onManualChange()">
          <input matSliderThumb>
        </mat-slider>
      </div>
      <!-- Yaw Slider -->
      <div class="control-item">
        <label>
          <mat-icon class="yaw-color">rotate_right</mat-icon>
          {{ 'HELMET.CONTROLS.YAW' | translate }}: {{ yawControl.toFixed(0) }}°
        </label>
        <mat-slider min="-180" max="180" step="1" [(ngModel)]="yawControl" (input)="onManualChange()">
          <input matSliderThumb>
        </mat-slider>
      </div>
    </div>
  </mat-card-content>
</mat-card>